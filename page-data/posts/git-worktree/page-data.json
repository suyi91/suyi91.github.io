{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/git-worktree","result":{"data":{"markdownRemark":{"id":"7971dc9a-de3a-50c1-8707-623ba75c0680","html":"<h2 id=\"intro\" style=\"position:relative;\"><a href=\"#intro\" aria-label=\"intro permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Intro</h2>\n<p>方便管理当前仓库多工作树的命令。</p>\n<p>可以省略git clone/git checkout操作在新的目录切代码。</p>\n<p>方便多分支同时管理和开发。</p>\n<h2 id=\"常用命令说明以purchase-view为例\" style=\"position:relative;\"><a href=\"#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E8%AF%B4%E6%98%8E%E4%BB%A5purchase-view%E4%B8%BA%E4%BE%8B\" aria-label=\"常用命令说明以purchase view为例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>常用命令说明(以purchase-view为例)</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># git help worktree的内容</span>\n<span class=\"token function\">git</span> worktree <span class=\"token function\">add</span> <span class=\"token punctuation\">[</span>-f<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--detach<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--checkout<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--lock<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-b <span class=\"token operator\">&lt;</span>new-branch<span class=\"token operator\">></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>path<span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>commit-ish<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree list <span class=\"token punctuation\">[</span>--porcelain<span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree lock <span class=\"token punctuation\">[</span>--reason <span class=\"token operator\">&lt;</span>string<span class=\"token operator\">></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">></span>\n<span class=\"token function\">git</span> worktree move <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>new-path<span class=\"token operator\">></span>\n<span class=\"token function\">git</span> worktree prune <span class=\"token punctuation\">[</span>-n<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-v<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--expire <span class=\"token operator\">&lt;</span>expire<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree remove <span class=\"token punctuation\">[</span>-f<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">></span>\n<span class=\"token function\">git</span> worktree unlock <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">></span></code></pre></div>\n<h3 id=\"worktree-add\" style=\"position:relative;\"><a href=\"#worktree-add\" aria-label=\"worktree add permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>worktree add</h3>\n<blockquote>\n<p>创建一个新的目录并checkout代码</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 在../purchase-view__master目录切origin/master分支的代码</span>\n➜  purchase-view git:<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span> <span class=\"token function\">git</span> worktree <span class=\"token function\">add</span> --checkout <span class=\"token punctuation\">..</span>/purchase-view__master origin/master\nPreparing worktree <span class=\"token punctuation\">(</span>detached HEAD 55dceaf4<span class=\"token punctuation\">)</span>\nHEAD is now at 55dceaf4 Merge branch <span class=\"token string\">'test'</span> into <span class=\"token string\">'master'</span>\n\n<span class=\"token comment\"># 新建成功后可以查看结果</span>\n➜  purchase-view git:<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span> ✗ <span class=\"token function\">git</span> worktree list\n/Users/sean/Documents/workspace/f6prj/purchase-view         e82c8f29 <span class=\"token punctuation\">[</span>test<span class=\"token punctuation\">]</span>\n/Users/sean/Documents/workspace/f6prj/purchase-view__master  55dceaf4 <span class=\"token punctuation\">(</span>detached HEAD<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"worktree-list\" style=\"position:relative;\"><a href=\"#worktree-list\" aria-label=\"worktree list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>worktree list</h3>\n<blockquote>\n<p>列举仓库的worktree情况</p>\n</blockquote>\n<p>可见<code class=\"language-text\">worktree add</code>中结果。</p>\n<h3 id=\"worktree-lockunlock\" style=\"position:relative;\"><a href=\"#worktree-lockunlock\" aria-label=\"worktree lockunlock permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>worktree lock/unlock</h3>\n<blockquote>\n<p>配置worktree某目录锁定和解锁动作。</p>\n<p>暂时没碰到使用场景。</p>\n</blockquote>\n<h3 id=\"worktree-move\" style=\"position:relative;\"><a href=\"#worktree-move\" aria-label=\"worktree move permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>worktree move</h3>\n<blockquote>\n<p>将working tree目录移动到新位置。主目录和带有子模块(submodules)的目录不可以移动。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">➜  purchase-view git:<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span> <span class=\"token function\">git</span> worktree move <span class=\"token punctuation\">..</span>/purchase-view__master <span class=\"token punctuation\">..</span>/new--purchase-view__master\n➜  purchase-view git:<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span> <span class=\"token function\">git</span> worktree list\n/Users/sean/Documents/workspace/f6prj/purchase-view               e82c8f29 <span class=\"token punctuation\">[</span>test<span class=\"token punctuation\">]</span>\n/Users/sean/Documents/workspace/f6prj/new--purchase-view__master  55dceaf4 <span class=\"token punctuation\">[</span>master<span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"worktree-remove\" style=\"position:relative;\"><a href=\"#worktree-remove\" aria-label=\"worktree remove permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>worktree remove</h3>\n<blockquote>\n<p>移除指定的worktree</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">➜  purchase-view git:<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span> <span class=\"token function\">git</span> worktree remove <span class=\"token punctuation\">..</span>/new--purchase-view__master\n➜  purchase-view git:<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span> <span class=\"token function\">git</span> worktree list\n/Users/sean/Documents/workspace/f6prj/purchase-view  e82c8f29 <span class=\"token punctuation\">[</span>test<span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"worktree-prune\" style=\"position:relative;\"><a href=\"#worktree-prune\" aria-label=\"worktree prune permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>worktree prune</h3>\n<blockquote>\n<p>清理worktree的配置信息 <span style=\"color:red\">$GIT_DIR/worktrees</span></p>\n</blockquote>\n<p>例如手动删除了一个worktree的文件夹但是没有执行<code class=\"language-text\">git worktree remove</code>，git并不能识别出已经删除了。</p>\n<p>可以使用<code class=\"language-text\">git worktree prune</code>手动更新项目的woktree配置。</p>\n<p>推荐使用<code class=\"language-text\">git worktree remove</code>移除worktree。</p>","fields":{"slug":"/posts/git-worktree","tagSlugs":["/tag/git/"]},"frontmatter":{"date":"2020-05-18 22:00","description":"git的worktree命令可以方便地checkout出多分支代码并且不需要重复clone代码仓库。","tags":["git"],"title":"git worktree","socialImage":""}}},"pageContext":{"slug":"/posts/git-worktree"}}}