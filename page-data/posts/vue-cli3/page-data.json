{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/vue-cli3","result":{"data":{"markdownRemark":{"id":"56baefa5-6fb9-585d-93c4-80de78271b09","html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>自从vue-cli推出了3.0版本之后就一直在研究使用，手头的新项目都上了3.0，2.0的老项目也切了几个。</p>\n<p>相较于2.0版本Webpack配置一大堆，3.0封装了绝大部分的Webpack相关配置并暴露了一些可配置的参数接口(比如<a href=\"https://cli.vuejs.org/zh/config/#vue-config-js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vue.config.js</a>文件)。</p>\n<p>3.0上手确实容易多了✈️</p>\n<blockquote>\n<p>封装之后上手是简单了，但是自定义也更加困难了。</p>\n</blockquote>\n<!-- more -->\n<h2 id=\"需求\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E6%B1%82\" aria-label=\"需求 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>需求</h2>\n<p>老项目有两个需求，<code class=\"language-text\">分页</code>和<code class=\"language-text\">分包缩减</code>。</p>\n<h3 id=\"分页\" style=\"position:relative;\"><a href=\"#%E5%88%86%E9%A1%B5\" aria-label=\"分页 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>分页</h3>\n<p>“分页”是业务上的需求，因为项目有两大业务类别，所以需要分包实现。参照官网的<a href=\"https://cli.vuejs.org/zh/config/#pages\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pages</a>配置即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  pages<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    index<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// page 的入口</span>\n      entry<span class=\"token operator\">:</span> <span class=\"token string\">'src/index/main.js'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// 模板来源</span>\n      template<span class=\"token operator\">:</span> <span class=\"token string\">'public/index.html'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// 在 dist/index.html 的输出</span>\n      filename<span class=\"token operator\">:</span> <span class=\"token string\">'index.html'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// 当使用 title 选项时，</span>\n      <span class=\"token comment\">// template 中的 title 标签需要是 &lt;title>&lt;%= htmlWebpackPlugin.options.title %>&lt;/title></span>\n      title<span class=\"token operator\">:</span> <span class=\"token string\">'Index Page'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// 在这个页面中包含的块，默认情况下会包含</span>\n      <span class=\"token comment\">// 提取出来的通用 chunk 和 vendor chunk。</span>\n      chunks<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'chunk-vendors'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'chunk-common'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'index'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 当使用只有入口的字符串格式时，</span>\n    <span class=\"token comment\">// 模板会被推导为 `public/subpage.html`</span>\n    <span class=\"token comment\">// 并且如果找不到的话，就回退到 `public/index.html`。</span>\n    <span class=\"token comment\">// 输出文件名会被推导为 `subpage.html`。</span>\n    subpage<span class=\"token operator\">:</span> <span class=\"token string\">'src/subpage/main.js'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"分包缩减\" style=\"position:relative;\"><a href=\"#%E5%88%86%E5%8C%85%E7%BC%A9%E5%87%8F\" aria-label=\"分包缩减 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>分包缩减</h3>\n<p>这个由用户反馈而来。因为项目中了用了一些UI库(通过<a href=\"https://github.com/webpack-contrib/webpack-bundle-analyzer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebpackBundleAnalyzer</a>观察得)，打包后的vendors包特别大，1M多，gzip后也有3、400k大小，直接影响首屏的加载，可以考虑的方法是将UI库分包。</p>\n<p>看了下Vue-cli 3的文档，没有相关分包加载的直接设置项，但是可以自定义Webpack的配置。</p>\n<p><a href=\"https://cli.vuejs.org/zh/config/#chainwebpack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">chainWebpack</a>——结合<a href=\"https://github.com/neutrinojs/webpack-chain\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webpack-chain</a>的链式操作API，直接修改项目Webpack配置。</p>\n<p><a href=\"https://cli.vuejs.org/zh/config/#configurewebpack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">configureWebpack</a>——将定义的配置对象merge到Webpack配置中。</p>\n<h4 id=\"chainwebpack\" style=\"position:relative;\"><a href=\"#chainwebpack\" aria-label=\"chainwebpack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>chainWebpack</h4>\n<p>直接操作Webpack配置，比如加入包分析工具<a href=\"https://github.com/webpack-contrib/webpack-bundle-analyzer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebpackBundleAnalyzer</a>、设置alias等等。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> WebpackBundleAnalyzer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack-bundle-analyzer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>BundleAnalyzerPlugin<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> isAnalyze <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 是否启用bundleAnalyzer</span>\n\n<span class=\"token comment\">// ...</span>\n\nmodule<span class=\"token punctuation\">.</span>defaults <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token function-variable function\">chainWebpack</span><span class=\"token operator\">:</span> <span class=\"token parameter\">config</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    config<span class=\"token punctuation\">.</span>resolve<span class=\"token punctuation\">.</span>alias <span class=\"token comment\">// 设置alias</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Less'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/less'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isAnalyze<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 设置bundle-analyzer</span>\n      config\n        <span class=\"token punctuation\">.</span><span class=\"token function\">plugin</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bundle-analyzer'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>WebpackBundleAnalyzer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"configurewebpack\" style=\"position:relative;\"><a href=\"#configurewebpack\" aria-label=\"configurewebpack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>configureWebpack</h4>\n<p>可以设置<a href=\"https://webpack.js.org/plugins/split-chunks-plugin/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">optimization.splitChunks.cacheGroups</code></a>配置分包。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 以拆element-ui为例</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  configureWebpack<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    optimization<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      splitChunks<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        cacheGroups<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          theme<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            name<span class=\"token operator\">:</span> <span class=\"token string\">'chunk-theme'</span><span class=\"token punctuation\">,</span>\n            test<span class=\"token operator\">:</span> <span class=\"token regex\">/[\\\\/]node_modules[\\\\/]element-ui[\\\\/]/</span><span class=\"token punctuation\">,</span>\n            chunks<span class=\"token operator\">:</span> <span class=\"token string\">'all'</span><span class=\"token punctuation\">,</span>\n            priority<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            reuseExistingChunk<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            enforce<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"分包实现\" style=\"position:relative;\"><a href=\"#%E5%88%86%E5%8C%85%E5%AE%9E%E7%8E%B0\" aria-label=\"分包实现 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>分包实现</h3>\n<h4 id=\"spa\" style=\"position:relative;\"><a href=\"#spa\" aria-label=\"spa permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SPA</h4>\n<p>如果是SPA，只需要通过vue-cli 3的默认配置和上面的<code class=\"language-text\">configureWebpack</code>配置即可实现。</p>\n<p>Sample配置如文末仓库。</p>\n<h4 id=\"mpa\" style=\"position:relative;\"><a href=\"#mpa\" aria-label=\"mpa permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MPA</h4>\n<p>如果是MPA，就没那么简单了。由于每个入口只需要自己的js和公共chunks、UI-chunk，所以默认的pages配置已经不能满足需求了(<a href=\"https://github.com/jantimon/html-webpack-plugin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">html-webpack-plugin</a>的一些参数vue-cli3并不支持配置，需要自己修改webpack配置实现)。</p>\n<p>所以这边的解决方案是:</p>\n<ul>\n<li>configureWebpack的内容不变，依然是ui分包的配置；</li>\n<li>不使用vue.config.js中的<code class=\"language-text\">pages</code>，在<code class=\"language-text\">chainWebpack</code>中自行加入<code class=\"language-text\">entry</code>和<code class=\"language-text\">HtmlWebpackPlugin</code>；</li>\n</ul>\n<p>具体实现就不写了，Sample配置见文末仓库。</p>\n<h3 id=\"注意点\" style=\"position:relative;\"><a href=\"#%E6%B3%A8%E6%84%8F%E7%82%B9\" aria-label=\"注意点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>注意点</h3>\n<blockquote>\n<p>在实现的时候遇到了一些问题，这边记录一下。</p>\n</blockquote>\n<h4 id=\"1-typeerror-cannot-read-property-tapasync-of-undefined\" style=\"position:relative;\"><a href=\"#1-typeerror-cannot-read-property-tapasync-of-undefined\" aria-label=\"1 typeerror cannot read property tapasync of undefined permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. <code class=\"language-text\">TypeError: Cannot read property &#39;tapAsync&#39; of undefined</code></h4>\n<p>google后得到结果是”html-webpack-plugin”不能放在”preload-webpack-plugin”的后面。<a href=\"https://github.com/GoogleChromeLabs/preload-webpack-plugin/issues/68\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">link</a></p>\n<p>配置chainWebpack时添加html-webpack-plugin时使用<code class=\"language-text\">.before(&#39;xxx&#39;)</code>方法即可。</p>\n<h4 id=\"2-配置了分页后，dev环境不能访问每个分页怎么办\" style=\"position:relative;\"><a href=\"#2-%E9%85%8D%E7%BD%AE%E4%BA%86%E5%88%86%E9%A1%B5%E5%90%8E%EF%BC%8Cdev%E7%8E%AF%E5%A2%83%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AE%E6%AF%8F%E4%B8%AA%E5%88%86%E9%A1%B5%E6%80%8E%E4%B9%88%E5%8A%9E\" aria-label=\"2 配置了分页后，dev环境不能访问每个分页怎么办 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 配置了分页后，dev环境不能访问每个分页怎么办</h4>\n<p>webpack-dev-server有一个参数配置<code class=\"language-text\">historyApiFallback</code>，可以实现dev模式下的分页访问。</p>\n<h4 id=\"3-indexhtml中的base_url未定义\" style=\"position:relative;\"><a href=\"#3-indexhtml%E4%B8%AD%E7%9A%84base_url%E6%9C%AA%E5%AE%9A%E4%B9%89\" aria-label=\"3 indexhtml中的base_url未定义 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. index.html中的BASE_URL未定义</h4>\n<p>默认情况下，vue-cli会给<code class=\"language-text\">process.env</code>注入几个属性值，其中就有<code class=\"language-text\">BASE_URL</code>，值为<code class=\"language-text\">&#39;/&#39;</code>。</p>\n<p>但是当进行MPA配置时是我们自写的插件配置，所以必须要将<code class=\"language-text\">BASE_URL</code>写入到htmlWebpackPlugin的<code class=\"language-text\">templateParameters</code>中。(即使vue.config.js中配置了<a href=\"https://cli.vuejs.org/zh/config/#baseurl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">baseUrl</a>)</p>\n<h2 id=\"sample\" style=\"position:relative;\"><a href=\"#sample\" aria-label=\"sample permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sample</h2>\n<p>见仓库<a href=\"https://github.com/suyi91/vue-cli3-samples\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">suyi91/vue-cli3-samples</a></p>","fields":{"slug":"/posts/vue-cli3","tagSlugs":["/tag/前端/","/tag/webpack/","/tag/vue/"]},"frontmatter":{"date":"2018-11-01 11:14:55","description":"","tags":["前端","webpack","vue"],"title":"vue-cli 3 多页应用与分包","socialImage":""}}},"pageContext":{"slug":"/posts/vue-cli3"}}}