<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.png"><meta name="generator" content="Astro v4.16.5"><!-- Canonical URL --><link rel="canonical" href="https://suyi.xyz/blog/vue-27-jsx-bugs/"><!-- Primary Meta Tags --><meta name="title" content="Suyi的小站"><meta name="description" content="记录自己的成长历程"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://suyi.xyz/blog/vue-27-jsx-bugs/"><meta property="og:title" content="Suyi的小站"><meta property="og:description" content="记录自己的成长历程"><meta property="og:image" content="https://suyi.xyz/avatar.jpg"><meta property="og:image:alt" content="记录自己的成长历程"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://suyi.xyz/blog/vue-27-jsx-bugs/"><meta property="twitter:title" content="Suyi的小站"><meta property="twitter:description" content="记录自己的成长历程"><meta property="twitter:image" content="https://suyi.xyz/avatar.jpg"><meta httpEquiv="X-UA-Compatible" content="IE=edge"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="sitemap" href="/sitemap-0.xml"><title>Buggy vue2.7 jsx</title><script src="/toggle-theme.js"></script><script async type="text/javascript" src="/load-mathjax.js"></script><script async type="text/javascript" src="/libs/mermaid_10.9.0_mermaid.min.js"></script><!-- Google tag (gtag.js) --><script src="https://www.googletagmanager.com/gtag/js?id=UA-98612723-2"></script><script>(function(){const ga = "UA-98612723-2";

        window.dataLayer = window.dataLayer || [];

        function gtag() {
          dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', ga);
      })();</script><link rel="stylesheet" href="/dist/fancybox.CjCWXgqo.css">
<link rel="stylesheet" href="/dist/about.9jTgl0wm.css">
<link rel="stylesheet" href="/dist/SidebarIcon.BtE89P7R.css">
<link rel="stylesheet" href="/dist/_slug_.DWWgbEhU.css">
<style>#donate-item-img{filter:grayscale(1)}#donate-item-img:hover{filter:blur(0px);cursor:pointer}.esa-sponsor{position:relative;width:100%;margin:40px 0}.esa-sponsor .qrshow{position:absolute;width:200px;height:200px;cursor:pointer;left:calc(50% - 100px);top:-170px;z-index:999;display:none;box-shadow:0 1px 15px #1b1f2326,0 0 1px #6a737d59}
.senseHint[data-astro-cid-fkcbqlzg]{position:absolute;left:5px;top:0;font-size:12px;color:#ccc}
</style><script type="module" src="/dist/hoisted.B1f8Bns9.js"></script></head><body class="bg-skin-secondary"> <header class="fixed top-0 w-full bg-skin-fill text-skin-base z-10"> <div class="flex items-center justify-between container"> <div class="block xl:hidden"> <button type="button" id="menu-icon" class="header-btn" title="Menu"> <i class="ri-menu-fill"></i> </button> <button type="button" id="menu-icon-close" class="header-btn hidden" title="Menu"> <i class="ri-close-fill"></i> </button>  </div> <a class="text-2xl p-4" href="/">Suyi的小站</a> <div class="flex items-center"> <div class="hidden xl:block"> <div class="flex items-center space-x-5 pr-4"> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/blog/1" target="_self" class="header-link-active hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-draft-line" data-astro-cid-eimmu3lg></i> Blog  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/feed/1" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-lightbulb-flash-line" data-astro-cid-eimmu3lg></i> Feed  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/archive/1" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-archive-line" data-astro-cid-eimmu3lg></i> Archive  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/search" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-search-line" data-astro-cid-eimmu3lg></i> Search  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/about" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-information-line" data-astro-cid-eimmu3lg></i> About  </a>  </div>  </div> </div> <button type="button" id="theme-btn" class="header-btn" title="Toggles light & dark" aria-label="auto" aria-live="polite"> <i id="moon-icon" class="ri-sun-line"></i> <i id="sun-icon" class="ri-moon-line"></i> </button> <div class="block xl:hidden"> <button type="button" id="aside-btn" class="header-btn" title="Open Aside Bar" aria-label="auto" aria-live="polite"> <i class="ri-user-line"></i> </button> <button type="button" id="aside-close-btn" class="header-btn hidden" title="Close Aside Bar" aria-label="auto" aria-live="polite"> <i class="ri-close-fill"></i> </button> <div id="blog-aside" class="absolute top-16 bg-skin-fill right-0 blog-aside hidden"></div>  </div> </div> </div> <div id="mobile-menu" class="hidden text-center overflow-y-auto pb-8" style="height: calc(100vh - 64px)"> <div class="py-2"> <a class=" hover:text-skin-active" href="/blog/1"> <i class="ri-draft-line"></i> <span>Blog</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/feed/1"> <i class="ri-lightbulb-flash-line"></i> <span>Feed</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/archive/1"> <i class="ri-archive-line"></i> <span>Archive</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/search"> <i class="ri-search-line"></i> <span>Search</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/about"> <i class="ri-information-line"></i> <span>About</span> </a>  <div class="space-y-4 text-sm">  </div> </div> </div> <div id="personal-info" class="hidden break-all overflow-y-auto pb-8" style="height: calc(100vh - 64px)"> <img class="avatar my-4 mx-auto" src="/avatar.jpg" alt="avatar"> <div class="mb-2 text-center">路漫漫其修远兮。</div> <div class="flex items-center justify-center flex-wrap"> <a title="github" href="https://github.com/suyi91" target="_blank"> <i class="ri-github-fill text-2xl mr-2 cursor-pointer"></i> </a><a title="email" href="mailto:suyi_2012@outlook.com" target="_blank"> <i class="ri-mail-line text-2xl mr-2 cursor-pointer"></i> </a> </div> <div class="divider-horizontal-mini"></div> <div class="text-center"> <div> <i class="ri-folder-line menu-icon"></i>分类 </div> <div class="my-2 break-all truncate"> <a class="hover:text-skin-active" title="前端 (2)" href="/category/前端"> 前端 (2) </a> </div> <div class="divider-horizontal-mini"></div>
          <div class="text-center"> <i class="ri-price-tag-3-line menu-icon"></i> 标签 </div> <div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="astro" href="/tags/astro">astro (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="vue" href="/tags/vue">vue (1)</a> </div> </div> </div> </header> <main class="container p-4  pt-20 text-skin-base min-h-full pb-32 relative" id="app"> <div class="grid grid-cols-4 gap-8"> <div class="col-span-4 xl:col-span-3 space-y-4"> <button class="flex items-center text-md cursor-pointer hover:text-skin-active outline-none" style="background-color: inherit;" onclick="history.back()"> <i class="ri-arrow-left-line mr-2"></i> <span>返回</span> </button>  <div> <div class="border-b-1"> <!-- title --> <h1 class="break-all text-xl font-bold">Buggy vue2.7 jsx</h1> <div class="flex flex-wrap items-center my-2 space-x-2"> <!-- date --> <i class="ri-calendar-2-fill"></i>
        <div class="tag">2024-10-21</div> <!-- draft -->  <!-- category --> <div class="divider-vertical"></div>
        <i class="ri-folder-3-line"></i>
        <a href="/category/前端" class="text-wrap break-all  hover:text-skin-active cursor-pointer">前端</a> <!-- tag --> <div class="divider-vertical"></div>
        <i class="ri-price-tag-3-line"></i>
        <a href="/tags/vue" class="text-wrap break-all hover:text-skin-active cursor-pointer">vue</a> <!-- update --> <div class="divider-vertical"></div>
        <i class="ri-calendar-check-fill"></i>
        <div class="tag">最后更新：2024-10-23</div> <!-- minutes --> <div class="divider-vertical"></div>
        <i class="ri-hourglass-fill"></i>
        <div class="tag">1分钟</div>
        <div class="divider-vertical"></div>
        <div class="tag">184字</div> </div> </div> <div class="divider-horizontal"></div> <article class="markdown-body"> <p>最近维护老项目引入了vue2.7和官方提供的jsx方案<code>jsx-vue2</code>，写着写着发现了几个坑…</p>
<h2 id="1-官方vue2的jsx插件vmodel报错">1. 官方vue2的jsx插件vModel报错</h2>
<blockquote>
<p>vModel: __currentInstance.$set is not a function</p>
</blockquote>
<p>相关issue讨论:</p>
<ul>
<li><a href="https://github.com/vuejs/jsx-vue2/issues/287">https://github.com/vuejs/jsx-vue2/issues/287</a></li>
<li><a href="https://github.com/vuejs/composition-api/issues/699">https://github.com/vuejs/composition-api/issues/699</a></li>
</ul>
<p>解决(回避)方案:</p>
<p>不用vModel语法糖了，回归原始用<code>value</code>和<code>onInput</code>替代吧。</p>
<h2 id="2-无法获取组件ref">2. 无法获取组件ref</h2>
<p>相关issue讨论:</p>
<ul>
<li><a href="https://github.com/vuejs/jsx-vue2/issues/288">https://github.com/vuejs/jsx-vue2/issues/288</a></li>
</ul>
<p>解决(回避)方案:</p>
<p>需要用函数手写ref赋值。</p>
<div class="expressive-code"><link rel="stylesheet" href="/dist/ec.r9qfg.css"><script type="module" src="/dist/ec.dy9ns.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">customRef</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">ref</span><span style="--0:#E1E4E8;--1:#24292E">()</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">2</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">3</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&#x3C;</span><span style="--0:#79B8FF;--1:#005CC5">SwitchSettingCommonModal</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">ref</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">{</span><span style="--0:#FFAB70;--1:#AE4B07">el</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=></span><span style="--0:#E1E4E8;--1:#24292E"> { customRef.value </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> el } </span><span style="--0:#F97583;--1:#BF3441">/></span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const customRef = ref()<SwitchSettingCommonModal ref={el => { customRef.value = el } />"><div></div></button></div></figure></div>
<hr>
<p>期待下一个坑🥹。</p>
<hr>
<p>因为vue2已经eol了，官方已经不再更新，所以不推荐再用vue2以及jsx了，有开发需要赶紧换3吧，3还没eol，如果有bug了官方团队应该会修的。。。😔</p> </article> <div class="divider-horizontal"></div> <div class="h-8 text-skin-base"> <a class="truncate  w-auto max-w-[40%] float-left" href="/blog/github-pages-deploy-astro" title="Astro github pages快速部署"> <i class="ri-arrow-left-s-fill"></i> Astro github pages快速部署 </a> <div class="flex item-center float-right w-auto max-w-[40%] text-right"> <a class="truncate " href="/blog/new-features-test" title="New features test"> New features test </a> <i class="ri-arrow-right-s-fill float-right"></i> </div> </div> <div class="my-4"> <div class="relative h-32 w-auto flex flex-col items-center justify-center bg-skin-card p-2" data-astro-cid-fkcbqlzg> <div class="senseHint" data-astro-cid-fkcbqlzg>广告</div> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9516394402935661" crossorigin="anonymous"></script> <!-- blog底部广告 --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9516394402935661" data-ad-slot="6055170909" data-ad-format="auto" data-full-width-responsive="true" data-astro-cid-fkcbqlzg></ins> <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script> </div> </div> <div class="border-l-4 my-4 p-4 border-l-skin-base bg-skin-card break-all"> <div>本文标题：Buggy vue2.7 jsx</div> <div>文章作者：Suyi</div> <div>发布时间：2024-10-21</div> <div> 原始链接：<a href="https://suyi.xyz/blog/vue-27-jsx-bugs" class="hover:text-skin-active">https://suyi.xyz/blog/vue-27-jsx-bugs</a> </div> </div>  </div>   </div> <div class="hidden xl:block col-span-1 relative"> <div class="shadow-lg rounded-lg h-64 w-auto flex flex-col items-center justify-center bg-skin-card p-2"> <img class="avatar mb-4" src="/avatar.jpg" alt="avatar"> <div class="mb-2 text-center">路漫漫其修远兮。</div> <div class="flex items-center justify-center flex-wrap"> <a title="github" href="https://github.com/suyi91" target="_blank"> <i class="ri-github-fill text-2xl mr-2 cursor-pointer"></i> </a><a title="email" href="mailto:suyi_2012@outlook.com" target="_blank"> <i class="ri-mail-line text-2xl mr-2 cursor-pointer"></i> </a> </div> </div> <div id="toc" class="shadow-lg rounded-lg my-4 py-2 px-2 bg-skin-card sticky top-20"> <div class="flex items-center border-b border-b-gray-300 mb-1"> <i class="ri-list-check menu-icon"></i> 文章目录 </div> <div class="overflow-auto"> <div class="toc-container"></div> </div> </div>  </div> <button type="button" id="scrollToTopBtn" class="header-btn fixed bottom-4 right-2 hidden" title="scroll to top"> <i class="ri-arrow-up-line"></i> </button>  </div> <div class="footer container p-4" data-astro-cid-sz7xmlte>  <div class="flex items-center flex-wrap justify-center mb-4 text-skin-base" data-astro-cid-sz7xmlte> <div data-astro-cid-sz7xmlte> <span class="cursor-default" data-astro-cid-sz7xmlte>Copyright</span> <i class="ri-copyright-line align-middle" data-astro-cid-sz7xmlte></i> <span class="align-middle" data-astro-cid-sz7xmlte>2024</span> </div>  <div class="divider-vertical" data-astro-cid-sz7xmlte></div> <a href="/sitemap-index.xml" data-astro-cid-sz7xmlte>站点地图</a> </div> </div>  </main> </body></html>